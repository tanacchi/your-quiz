# 技術選定

## フロントエンド技術選定

### フレームワーク選定

| フレームワーク | メリット | デメリット | 適用場面 | 学習曲線 | チーム適合性 | エコシステム | 判定 |
|---------------|----------|------------|----------|----------|------------|------------|------|
| **Next.js 15** | **・App Router対応**<br>**・SSR/SSG標準**<br>**・PWA対応容易**<br>**・TypeScript最適化**<br>**・Vercel統合** | **・設定複雑**<br>**・バンドルサイズ大** | **・SEO重要**<br>**・PWA必要**<br>**・TypeScript**<br>**・モバイル最適化** | **中** | **高** | **★★★** | **○** |
| React Router v7 | ・軽量<br>・SPA特化<br>・設定シンプル<br>・高速 | ・SSR未対応<br>・PWA設定手動<br>・SEO弱い<br>・エコシステム小 | ・SPA中心<br>・軽量化重視<br>・独自設定 | 低 | 中 | ★★ | △ |

**選定結果**: Next.js 15
**選定理由**: 
1. PWA対応によるオフライン機能実装が容易
2. スマートフォン最適化（SSR・画像最適化）
3. TypeScript開発体験の最適化
4. 将来のSEO対応（検索機能等）への拡張性

### UI・スタイリング

| 技術 | メリット | デメリット | 適用場面 | 開発効率 | バンドル影響 | 判定 |
|------|----------|------------|----------|----------|------------|------|
| **Tailwind CSS** | **・Utility-First**<br>**・カスタマイズ容易**<br>**・TypeScript対応**<br>**・モバイル最適化** | **・HTML肥大化**<br>**・学習コスト** | **・カスタムデザイン**<br>**・レスポンシブ**<br>**・高速開発** | **高** | **中** | **○** |
| styled-components | ・CSS-in-JS<br>・動的スタイル<br>・TypeScript統合 | ・ランタイムコスト<br>・バンドルサイズ大<br>・SSR複雑 | ・動的テーマ<br>・コンポーネント指向 | 中 | 高 | △ |

**選定結果**: Tailwind CSS
**選定理由**: Tinder UI（スワイプ）実装時のアニメーション・レスポンシブ対応が容易

### 状態管理

| ライブラリ | メリット | デメリット | 適用場面 | TypeScript対応 | 学習コスト | 判定 |
|-----------|----------|------------|----------|---------------|-----------|------|
| **Zustand** | **・軽量**<br>**・TypeScript最適**<br>**・設定シンプル**<br>**・React統合** | **・エコシステム小**<br>**・複雑状態管理制限** | **・中小規模**<br>**・TypeScript**<br>**・シンプル要件** | **★★★** | **低** | **○** |
| Redux Toolkit | ・成熟<br>・DevTools充実<br>・パターン確立 | ・設定複雑<br>・ボイラープレート<br>・過剰機能 | ・大規模<br>・複雑状態<br>・チーム開発 | ★★ | 高 | △ |

**選定結果**: Zustand
**選定理由**: クイズ状態・履歴管理のシンプルな要件に適合、TypeScript開発体験良好

## バックエンド技術選定

### APIフレームワーク

| フレームワーク | メリット | デメリット | 適用場面 | パフォーマンス | TypeScript対応 | エコシステム | 判定 |
|---------------|----------|------------|----------|---------------|---------------|------------|------|
| **Hono** | **・超軽量**<br>**・TypeScript設計**<br>**・エッジ対応**<br>**・100ms要件対応** | **・エコシステム小**<br>**・実績少**<br>**・プラグイン限定** | **・パフォーマンス重視**<br>**・軽量API**<br>**・TypeScript** | **★★★** | **★★★** | **★** | **○** |
| Nest.js | ・成熟フレームワーク<br>・DI・デコレータ<br>・エコシステム豊富<br>・エンタープライズ対応 | ・重い<br>・設定複雑<br>・学習コスト高<br>・オーバーヘッド | ・大規模API<br>・複雑ビジネスロジック<br>・チーム開発 | ★★ | ★★ | ★★★ | △ |

**選定結果**: Hono
**選定理由**: 
1. API応答時間100ms要件への最適化
2. TypeScriptファーストの開発体験
3. シンプルなAPI要件（CRUD中心）に適合

### データベース選定

| データベース | メリット | デメリット | 適用場面 | 運用コスト | 学習曲線 | チーム適合性 | 判定 |
|-------------|----------|------------|----------|------------|----------|------------|------|
| **SQLite** | **・ファイルベース**<br>**・設定不要**<br>**・軽量**<br>**・ACID準拠** | **・同時書き込み制限**<br>**・水平スケール不可** | **・小中規模**<br>**・開発初期**<br>**・MVP** | **低** | **低** | **高** | **○** |
| PostgreSQL | ・高機能<br>・拡張性高<br>・JSON対応<br>・ACID厳密 | ・設定複雑<br>・メモリ消費<br>・運用コスト高 | ・複雑クエリ<br>・大規模データ<br>・本格運用 | 高 | 高 | 中 | △ |

**選定結果**: SQLite（開発初期）→ PostgreSQL（本格運用）
**選定理由**: 
1. 開発効率重視でSQLiteからスタート
2. 同時接続100以下の要件に適合
3. 将来的なPostgreSQL移行パス確保

### ORM選定

| ORM | メリット | デメリット | 適用場面 | TypeScript対応 | パフォーマンス | 判定 |
|-----|----------|------------|----------|---------------|---------------|------|
| **Drizzle ORM** | **・TypeScript特化**<br>**・軽量**<br>**・SQL透明性**<br>**・型安全性** | **・新しい**<br>**・エコシステム小**<br>**・学習リソース少** | **・TypeScript**<br>**・パフォーマンス重視**<br>**・SQL制御** | **★★★** | **★★★** | **○** |
| Prisma | ・成熟<br>・スキーマ管理<br>・マイグレーション<br>・Admin UI | ・重い<br>・クエリ制限<br>・ランタイムコスト | ・RAD開発<br>・チーム開発<br>・管理機能重視 | ★★ | ★★ | △ |

**選定結果**: Drizzle ORM
**選定理由**: TypeScript開発体験とパフォーマンス要件（100ms）への最適化

## インフラ・運用技術選定

### フロントエンドホスティング

| プラットフォーム | メリット | デメリット | 適用場面 | 無料枠 | パフォーマンス | 判定 |
|------------------|----------|------------|----------|--------|---------------|------|
| **Vercel** | **Next.js最適化、自動デプロイ、エッジ配信、PWA対応** | **ベンダーロック、API制限、コスト上昇** | **Next.js、フロントエンド中心、高速配信** | **100GB/月** | **★★★** | **○** |
| Netlify | Git統合、フォーム対応、Functions、CDN | 遅延問題、ビルド制限、複雑設定時問題 | 静的サイト、JAMstack、シンプル構成 | 100GB/月 | ★★ | △ |
| Cloudflare Pages | 高速配信、無制限帯域、低レイテンシ、エッジ最適化 | 機能限定、新しいサービス、学習コスト | エッジ重視、グローバル配信、高速化 | 無制限 | ★★★ | ○ |

**選定結果**: Vercel

**選定理由**: Next.js最適化、PWA対応、100ms要件への最適化

### APIホスティング（バックエンド）

| プラットフォーム | メリット | デメリット | 適用場面 | 無料枠 | パフォーマンス | 技術適合性 | 判定 |
|------------------|----------|------------|----------|--------|---------------|------------|------|
| **Railway** | **シンプル設定、DB統合、Git連携、スケーリング自動** | **新しいサービス、実績少、料金体系変更リスク** | **フルスタック、小中規模、MVP開発** | **$5クレジット/月** | **★★★** | **Hono対応** | **○** |
| Render | Docker対応、DB統合、自動デプロイ、実績豊富 | 無料枠制限厳しい、スリープ問題、設定複雑 | Docker化、安定運用、エンタープライズ | 750時間/月 | ★★ | Hono対応 | △ |
| Fly.io | エッジ配信、低レイテンシ、Docker最適、グローバル展開 | 設定複雑、学習コスト高、課金体系複雑 | エッジコンピューティング、レイテンシ重視 | $5クレジット/月 | ★★★ | Hono最適 | ○ |
| Supabase Functions | PostgreSQL統合、Edge Functions、Auth統合、TypeScript | Serverless制限、実行時間制限、デバッグ困難 | DB重視、Auth必要、Serverless | 500MB DB無料 | ★★ | TypeScript対応 | △ |
| PlanetScale + Vercel Functions | MySQL互換、ブランチング、自動スケール、エッジ | コスト高、ベンダーロック、複雑構成 | 大規模DB、ブランチ運用 | 10GB DB無料 | ★★ | 要適合作業 | △ |
| Cloudflare Workers | 超高速、エッジ実行、無制限リクエスト、低コスト | 実行時間制限、Node.js制限、デバッグ困難 | エッジAPI、高トラフィック、シンプル処理 | 100,000req/日 | ★★★ | Hono最適化 | ○ |

#### 詳細比較：Railway vs Fly.io vs Cloudflare Workers

| 項目 | Railway | Fly.io | Cloudflare Workers |
|------|---------|--------|-------------------|
| **起動時間** | ~500ms | ~200ms | ~1ms |
| **コールドスタート** | あり | あり | なし |
| **100ms要件対応** | △（ウォームアップ必要） | ○（エッジ配置） | ○（エッジネイティブ） |
| **データベース** | 統合PostgreSQL | 外部接続 | 外部接続（D1/KV） |
| **無料枠** | $5/月クレジット | $5/月クレジット | 100,000req/日 |
| **運用負荷** | 低 | 中 | 低 |
| **学習コスト** | 低 | 中 | 中 |

**選定結果**: **Cloudflare Workers + D1 Database**

**選定理由**:

1. **Hono最適化**: HonoはCloudflare Workers向けに設計されており最高の親和性
2. **100ms要件対応**: エッジ実行でコールドスタートなし（~1ms起動）
3. **十分な無料枠**: 100,000リクエスト/日 + 25GB DB - クイズアプリには十分
4. **クイズアプリの特性**: 複雑なクエリ不要、CRUD中心の単純な処理
5. **運用シンプル**: 単一プラットフォームで完結、管理負荷最小

**D1制約の対応**:
- SQLite互換のため、既存のDrizzle ORMとSQLite開発経験が活用可能
- クイズデータのシンプルな構造には十分
- 分析等が必要になった場合のみ、後からNeon等への移行を検討

### データベースホスティング

| サービス | メリット | デメリット | 無料枠 | パフォーマンス | 適用時期 |
|----------|----------|------------|--------|---------------|----------|
| **D1 Database (Cloudflare)** | **エッジ配置、超高速、SQLite互換、無料枠大** | **機能制限、新しいサービス、分析クエリ弱** | **25GB** | **★★★** | **MVP期** |
| Neon PostgreSQL | Serverless、ブランチング、自動スケール | 新しい、制限あり、レイテンシ | 3GB | ★★ | 成長期 |
| PlanetScale MySQL | ブランチング、自動スケール、企業実績 | 高コスト、MySQL制約 | 10GB | ★★ | スケール期 |
| Railway PostgreSQL | 統合管理、シンプル設定、自動バックアップ | 単一AZ、制限あり | $5クレジット分 | ★★ | 安定期 |

**選定結果**: **D1 Database**（Cloudflare Workers統合）

**選定理由**: SQLite互換でシンプル、25GB無料枠、エッジ配置による高速アクセス

### 開発ツール（Linting・フォーマット）

| ツール | メリット | デメリット | 適用場面 | TypeScript統合 | 学習コスト | 判定 |
|--------|----------|------------|----------|---------------|-----------|------|
| **Biome** | **Rust製高速、Lint+Format統合、TypeScript最適、設定シンプル** | **新しい技術、プラグイン少、移行コスト** | **TypeScript中心、高速化重視、設定簡素化** | **★★★** | **低** | **○** |
| ESLint + Prettier | 成熟、プラグイン豊富、カスタマイズ性、実績多数 | 設定複雑、実行速度、依存関係多 | カスタマイズ重視、プラグイン活用、既存プロジェクト | ★★ | 中 | △ |

**選定結果**: Biome

**選定理由**: TypeScript開発体験の最適化、設定の単純化、100ms要件に向けた高速処理

### CI/CD・デプロイメント

#### CI/CDプラットフォーム選定

| プラットフォーム | メリット | デメリット | 適用場面 | コスト | 設定容易さ | 判定 |
|------------------|----------|------------|----------|--------|------------|------|
| **GitHub Actions** | **GitHub統合、YAML設定、豊富なAction、無料枠充実** | **実行時間制限、複雑ワークフロー管理困難** | **OSS・小中規模、GitHub中心開発** | **低** | **高** | **○** |
| CircleCI | 高機能、Docker最適化、並列実行、企業実績 | 設定複雑、コスト高、学習コスト | 大規模、Docker中心、CI/CD特化 | 高 | 中 | △ |
| GitLab CI | GitLab統合、Runner自由度、企業機能充実 | GitLab依存、設定複雑、運用負荷 | GitLab中心、セルフホスト、企業向け | 中 | 中 | × |

**選定結果**: GitHub Actions

**選定理由**:

1. GitHub中心の開発フローとの統合
2. Vercel・Cloudflare Workers自動デプロイとの親和性
3. 小規模チームでの運用負荷軽減

#### デプロイ戦略

| 戦略 | メリット | デメリット | 適用場面 | 自動化レベル | リスク | 判定 |
|------|----------|------------|----------|-------------|--------|------|
| **自動デプロイ** | **高速リリース、人的エラー削減、一貫性確保** | **障害時影響大、ロールバック複雑** | **開発効率重視、安定コードベース** | **高** | **中** | **○** |
| 手動デプロイ | 制御可能、慎重なリリース、問題早期発見 | 遅延、人的エラー、属人化 | 重要システム、初期段階 | 低 | 低 | △ |

**選定結果**: 自動デプロイ（段階的導入）

**選定理由**:

1. 開発速度重視のMVP段階
2. Vercel（Frontend）・Cloudflare Workers（Backend）の自動デプロイ機能活用
3. テスト自動化による品質ゲート設置

#### 品質ゲート戦略

```yaml
# GitHub Actions ワークフロー例
name: Quality Gate
on: [push, pull_request]
jobs:
  quality-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      # 並列実行による高速化
      - name: Install dependencies
        run: npm ci
      
      - name: Lint check
        run: npm run lint
      
      - name: Type check  
        run: npm run type-check
      
      - name: Unit tests
        run: npm run test
      
      - name: Build check
        run: npm run build
      
      # 失敗時は後続デプロイをブロック
      - name: Deploy (on success)
        if: success()
        run: echo "Deploy to staging"
```

## まとめ

### 採用技術スタック

**フロントエンド**:
- Framework: Next.js 15 (App Router)
- Styling: Tailwind CSS
- State: Zustand
- Language: TypeScript

**バックエンド**:
- Framework: Hono
- Database: SQLite → PostgreSQL
- ORM: Drizzle ORM
- Language: TypeScript

**インフラ・運用**:

- Frontend Hosting: Vercel
- Backend Hosting: Cloudflare Workers
- Database: D1 Database
- CI/CD: GitHub Actions
- Linting: Biome

### アーキテクチャ整合性確認
- ✅ モジュラーモノリス: 単一リポジトリ、境界明確なモジュール構成
- ✅ ヘキサゴナルアーキテクチャ: Drizzle ORMによるリポジトリパターン実装
- ✅ TypeScript統一: フロントエンド・バックエンド全体での型安全性
- ✅ パフォーマンス要件: Hono + Cloudflare Workers エッジ実行による100ms要件対応
- ✅ PWA対応: Next.js + Vercelによるオフライン機能実装
- ✅ 費用効率: Cloudflare Workers（100,000req/日無料）+ D1 Database（25GB無料）
- ✅ 運用シンプル: 単一プラットフォーム（Cloudflare）で完結