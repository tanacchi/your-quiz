
# 技術選定

## フロントエンド技術選定

### フレームワーク選定

| フレームワーク | メリット | デメリット | 適用場面 | 学習曲線 | チーム適合性 | エコシステム | 判定 |
|---------------|----------|------------|----------|----------|------------|------------|------|
| **Next.js 15** | **・App Router対応**<br>**・SSR/SSG標準**<br>**・PWA対応容易**<br>**・TypeScript最適化**<br>**・Vercel統合** | **・設定複雑**<br>**・バンドルサイズ大** | **・SEO重要**<br>**・PWA必要**<br>**・TypeScript**<br>**・モバイル最適化** | **中** | **高** | **★★★** | **○** |
| React Router v7 | ・軽量<br>・SPA特化<br>・設定シンプル<br>・高速 | ・SSR未対応<br>・PWA設定手動<br>・SEO弱い<br>・エコシステム小 | ・SPA中心<br>・軽量化重視<br>・独自設定 | 低 | 中 | ★★ | △ |

**選定結果**: Next.js 15
**選定理由**:

1. PWA対応によるオフライン機能実装が容易
2. スマートフォン最適化（SSR・画像最適化）
3. TypeScript開発体験の最適化
4. 将来のSEO対応（検索機能等）への拡張性

### UI・スタイリング

| 技術 | メリット | デメリット | 適用場面 | 開発効率 | バンドル影響 | 判定 |
|------|----------|------------|----------|----------|------------|------|
| **Tailwind CSS** | **・Utility-First**<br>**・カスタマイズ容易**<br>**・TypeScript対応**<br>**・モバイル最適化** | **・HTML肥大化**<br>**・学習コスト** | **・カスタムデザイン**<br>**・レスポンシブ**<br>**・高速開発** | **高** | **中** | **○** |
| styled-components | ・CSS-in-JS<br>・動的スタイル<br>・TypeScript統合 | ・ランタイムコスト<br>・バンドルサイズ大<br>・SSR複雑 | ・動的テーマ<br>・コンポーネント指向 | 中 | 高 | △ |

**選定結果**: Tailwind CSS
**選定理由**: Tinder UI（スワイプ）実装時のアニメーション・レスポンシブ対応が容易

### 状態管理

| ライブラリ | メリット | デメリット | 適用場面 | TypeScript対応 | 学習コスト | 判定 |
|-----------|----------|------------|----------|---------------|-----------|------|
| ライブラリ | メリット | デメリット | 適用場面 | TypeScript対応 | 学習コスト | 判定 |
|-----------|----------|------------|----------|---------------|-----------|------|
| Zustand | 軽量・TypeScript最適・設定シンプル・React統合 | エコシステム小・複雑状態管理制限 | 中小規模・TypeScript・シンプル要件 | ★★★ | 低 | ○ |
| Redux Toolkit | 成熟・DevTools充実・パターン確立 | 設定複雑・ボイラープレート・過剰機能 | 大規模・複雑状態・チーム開発 | ★★ | 高 | △ |
| Jotai | 軽量・原子設計・TypeScript対応 | エコシステム小・複雑状態管理制限 | 小規模・TypeScript・シンプル要件 | ★★★ | 低 | △ |
| Recoil | Facebook製・グラフ構造・TypeScript対応 | 学習コスト・エコシステム限定 | 中規模・依存関係複雑・TypeScript | ★★ | 中 | △ |
| MobX | リアクティブ・TypeScript対応・柔軟 | 学習コスト・パターン多様 | 中規模・リアクティブ・TypeScript | ★★ | 中 | △ |

**選定結果**: Zustand
**選定理由**:
- クイズ状態・履歴管理の要件がシンプルで、TypeScriptとの親和性・軽量性・設定容易さが最適
- Redux Toolkit等は大規模・複雑な状態管理には有効だが、現状の規模・要件にはオーバースペック

## バックエンド技術選定

### APIフレームワーク

| フレームワーク | メリット | デメリット | 適用場面 | パフォーマンス | TypeScript対応 | エコシステム | 判定 |
|---------------|----------|------------|----------|---------------|---------------|------------|------|
| **Hono** | **・超軽量**<br>**・TypeScript設計**<br>**・エッジ対応**<br>**・100ms要件対応** | **・エコシステム小**<br>**・実績少**<br>**・プラグイン限定** | **・パフォーマンス重視**<br>**・軽量API**<br>**・TypeScript** | **★★★** | **★★★** | **★** | **○** |
| Nest.js | ・成熟フレームワーク<br>・DI・デコレータ<br>・エコシステム豊富<br>・エンタープライズ対応 | ・重い<br>・設定複雑<br>・学習コスト高<br>・オーバーヘッド | ・大規模API<br>・複雑ビジネスロジック<br>・チーム開発 | ★★ | ★★ | ★★★ | △ |

**選定結果**: Hono
**選定理由**:

1. API応答時間100ms要件への最適化
2. TypeScriptファーストの開発体験
3. シンプルなAPI要件（CRUD中心）に適合

### データベース選定

| データベース | メリット | デメリット | 適用場面 | 運用コスト | 学習曲線 | チーム適合性 | 判定 |
|-------------|----------|------------|----------|------------|----------|------------|------|
| D1 (Cloudflare) | エッジ配置・SQLite互換・無料枠大 | 機能制限・新サービス・分析クエリ弱 | MVP・エッジ重視 | 低 | 低 | 高 | ○ |
| SQLite | ファイルベース・設定不要・軽量・ACID準拠 | 同時書き込み制限・水平スケール不可 | 小中規模・開発初期・MVP | 低 | 低 | 高 | ○ |
| PostgreSQL | 高機能・拡張性高・JSON対応・ACID厳密 | 設定複雑・メモリ消費・運用コスト高 | 複雑クエリ・大規模データ・本格運用 | 高 | 高 | 中 | ○ |
| Neon PostgreSQL | Serverless・ブランチング・自動スケール | 新しい・制限あり・レイテンシ | 成長期・Postgres互換 | 中 | 中 | 中 | △ |
| PlanetScale MySQL | ブランチング・自動スケール・企業実績 | 高コスト・MySQL制約 | スケール期 | 高 | 高 | 中 | △ |
| Railway PostgreSQL | 統合管理・シンプル設定・自動バックアップ | 単一AZ・制限あり | 安定期 | 中 | 中 | 中 | △ |

**選定結果**: D1 (Cloudflare, SQLiteベース)
**選定理由**:
- SQLite互換で既存エコシステム・開発経験が活用可能
- エッジ配置による高速アクセス・無料枠が十分
- 運用・スケール・リプレース容易性を重視

### ORM選定

| ORM | メリット | デメリット | 適用場面 | TypeScript対応 | パフォーマンス | 判定 |
|-----|----------|------------|----------|---------------|---------------|------|
| Drizzle ORM | TypeScript特化・軽量・SQL透明性・型安全性 | 新しい・エコシステム小・学習リソース少 | TypeScript・パフォーマンス重視・SQL制御 | ★★★ | ★★★ | ○ |
| Prisma | 成熟・スキーマ管理・マイグレーション・Admin UI | 重い・クエリ制限・ランタイムコスト | RAD開発・チーム開発・管理機能重視 | ★★ | ★★ | ○ |
| TypeORM | デコレータ・ActiveRecord・複雑クエリ対応 | 設定複雑・実行時型チェック・パフォーマンス課題 | 既存システム・複雑ドメイン | ★★ | ★ | △ |
| Kysely | クエリビルダー・型安全・軽量・SQL制御 | ORM機能なし・マイグレーション別途・学習コスト | パフォーマンス重視・SQL熟練者 | ★★★ | ★★★ | △ |

**選定結果**: Drizzle ORM
**選定理由**:
- TypeScript特化・軽量・SQL透明性・型安全性が現状の要件に最適
- Prismaは成熟しているが、現状の規模・パフォーマンス要件ではDrizzle ORMが優位
- Postgres移行時もDrizzle ORMは対応可能

## インフラ・運用技術選定

### フロントエンドホスティング

| プラットフォーム | メリット | デメリット | 適用場面 | 無料枠 | パフォーマンス | 判定 |
|------------------|----------|------------|----------|--------|---------------|------|
| **Vercel** | **Next.js最適化、自動デプロイ、エッジ配信、PWA対応** | **ベンダーロック、API制限、コスト上昇** | **Next.js、フロントエンド中心、高速配信** | **100GB/月** | **★★★** | **○** |
| Netlify | Git統合、フォーム対応、Functions、CDN | 遅延問題、ビルド制限、複雑設定時問題 | 静的サイト、JAMstack、シンプル構成 | 100GB/月 | ★★ | △ |
| Cloudflare Pages | 高速配信、無制限帯域、低レイテンシ、エッジ最適化 | 機能限定、新しいサービス、学習コスト | エッジ重視、グローバル配信、高速化 | 無制限 | ★★★ | ○ |

**選定結果**: Vercel

**選定理由**: Next.js最適化、PWA対応、100ms要件への最適化

### APIホスティング（バックエンド）

| プラットフォーム | メリット | デメリット | 適用場面 | 無料枠 | パフォーマンス | 技術適合性 | 判定 |
|------------------|----------|------------|----------|--------|---------------|------------|------|
| Cloudflare Workers | 超高速、エッジ実行、無制限リクエスト、低コスト | 実行時間制限、Node.js制限、デバッグ困難 | エッジAPI、高トラフィック、シンプル処理 | 100,000req/日 | ★★★ | Hono最適化 | ○ |
| Railway | シンプル設定、DB統合、Git連携、スケーリング自動 | 新しいサービス、実績少、料金体系変更リスク | フルスタック、小中規模、MVP開発 | $5クレジット/月 | ★★★ | Hono対応 | ○ |
| Render | Docker対応、DB統合、自動デプロイ、実績豊富 | 無料枠制限厳しい、スリープ問題、設定複雑 | Docker化、安定運用、エンタープライズ | 750時間/月 | ★★ | Hono対応 | △ |
| Fly.io | エッジ配信、低レイテンシ、Docker最適、グローバル展開 | 設定複雑、学習コスト高、課金体系複雑 | エッジコンピューティング、レイテンシ重視 | $5クレジット/月 | ★★★ | Hono最適 | ○ |
| Supabase Functions | PostgreSQL統合、Edge Functions、Auth統合、TypeScript | Serverless制限、実行時間制限、デバッグ困難 | DB重視、Auth必要、Serverless | 500MB DB無料 | ★★ | TypeScript対応 | △ |
| PlanetScale + Vercel Functions | MySQL互換、ブランチング、自動スケール、エッジ | コスト高、ベンダーロック、複雑構成 | 大規模DB、ブランチ運用 | 10GB DB無料 | ★★ | 要適合作業 | △ |

#### 詳細比較：Railway vs Fly.io vs Cloudflare Workers

| 項目 | Railway | Fly.io | Cloudflare Workers |
|------|---------|--------|-------------------|
| **起動時間** | ~500ms | ~200ms | ~1ms |
| **コールドスタート** | あり | あり | なし |
| **100ms要件対応** | △（ウォームアップ必要） | ○（エッジ配置） | ○（エッジネイティブ） |
| **データベース** | 統合PostgreSQL | 外部接続 | 外部接続（D1/KV） |
| **無料枠** | $5/月クレジット | $5/月クレジット | 100,000req/日 |
| **運用負荷** | 低 | 中 | 低 |
| **学習コスト** | 低 | 中 | 中 |

**選定結果**: Cloudflare Workers + D1 Database
**選定理由**:
1. HonoはCloudflare Workers向けに設計されており最高の親和性
2. 100ms要件対応: エッジ実行でコールドスタートなし（~1ms起動）
3. 十分な無料枠: 100,000リクエスト/日 + 25GB DB - クイズアプリには十分
4. クイズアプリの特性: 複雑なクエリ不要、CRUD中心の単純な処理
5. 運用シンプル: 単一プラットフォームで完結、管理負荷最小
6. D1はSQLite互換で、将来的なPostgres移行も視野に入る（Neon等）。DBはアプリケーションと違いリプレースが困難なため、初期選定時にPostgres互換性・移行性を重視すること。

#### 2.4 エラーハンドリングライブラリ

**選定必須理由**: TypeScript環境での関数型エラーハンドリング統一のため

| ライブラリ | メリット | デメリット | 適用場面 | 学習コスト | メンテナンス性 | パフォーマンス | 判定 |
|------------|----------|------------|----------|------------|---------------|--------------|------|
| **neverthrow** | ・Result型提供<br>・型安全なエラー処理<br>・関数型プログラミング対応<br>・TypeScript最適化 | ・学習曲線急<br>・既存コード移行コスト<br>・チーム教育必要 | ・API結果処理<br>・ビジネスロジック<br>・外部連携 | 中 | 高 | 高 | ○ |
| fp-ts | ・高機能<br>・関数型エコシステム充実<br>・数学的厳密性 | ・学習コスト極高<br>・オーバーエンジニアリング<br>・可読性低下リスク | ・関数型プログラミング中心<br>・複雑なデータ変換 | 高 | 高 | 中 | × |
| 独自実装 | ・プロジェクト特化<br>・軽量<br>・完全制御 | ・テスト負荷<br>・保守コスト<br>・バグリスク | ・シンプルな要件<br>・特殊制約 | 低 | 低 | 高 | △ |

**選定結果**: neverthrow
**選定理由**:

- TypeScript環境に最適化されており型安全性が高い
- 学習コストは中程度でチーム導入可能
- Result型による統一的なエラーハンドリングが実現可能

#### 2.5 テストフレームワーク

**選定必須理由**: TypeScript対応・高速実行・Vite統合のため

| フレームワーク | メリット | デメリット | 適用場面 | 実行速度 | TypeScript対応 | 設定容易さ | 判定 |
|---------------|----------|------------|----------|----------|---------------|------------|------|
| **Vitest** | ・Vite統合<br>・高速実行<br>・TypeScript最適<br>・Jest互換API | ・新しい技術<br>・エコシステム発展途上<br>・学習リソース限定 | ・Viteプロジェクト<br>・モダンテスト<br>・高速開発 | 高 | 高 | 高 | ○ |
| Jest | ・成熟エコシステム<br>・豊富な機能<br>・学習リソース多<br>・企業採用実績 | ・設定複雑<br>・実行速度<br>・ESM対応課題 | ・従来型開発<br>・安定性重視<br>・大規模テスト | 中 | 中 | 中 | △ |

**選定結果**: Vitest
**選定理由**:

- Viteとの統合により高速なテスト実行が可能
- TypeScript対応が優秀で型安全なテストが実現できる
- Jest互換APIで既存知識を活用可能

#### 2.6 型定義・コード生成ツール

**選定必須理由**: OpenAPI仕様からTypeScript型を自動生成し、型安全なAPI開発を実現するため

| ツール | メリット | デメリット | 適用場面 | 型安全性 | 保守性 | 学習コスト | 判定 |
|--------|----------|------------|----------|----------|--------|------------|------|
| **openapi-typescript** | ・OpenAPI→TypeScript<br>・自動生成<br>・型安全なAPI呼び出し<br>・フロントエンド統合 | ・生成ファイル大<br>・カスタマイズ制限<br>・OpenAPI依存 | ・API型定義<br>・フロント/バック統合<br>・TypeSpec連携 | 高 | 中 | 低 | ○ |
| 手動定義 | ・柔軟性<br>・カスタマイズ自由 | ・保守負荷<br>・型漏れリスク<br>・自動化不可 | ・小規模API<br>・特殊要件 | 中 | 低 | 高 | × |

**選定結果**: openapi-typescript
**選定理由**:

- OpenAPI仕様から自動で型定義を生成できるため、型安全性と保守性が高い
- フロントエンド・バックエンド間の型不整合リスクを低減できる

1. **Hono最適化**: HonoはCloudflare Workers向けに設計されており最高の親和性
2. **100ms要件対応**: エッジ実行でコールドスタートなし（~1ms起動）
3. **十分な無料枠**: 100,000リクエスト/日 + 25GB DB - クイズアプリには十分
4. **クイズアプリの特性**: 複雑なクエリ不要、CRUD中心の単純な処理
5. **運用シンプル**: 単一プラットフォームで完結、管理負荷最小

**D1制約の対応**:

- SQLite互換のため、既存のDrizzle ORMとSQLite開発経験が活用可能
- クイズデータのシンプルな構造には十分
- 分析等が必要になった場合のみ、後からNeon等への移行を検討

### データベースホスティング

| サービス | メリット | デメリット | 無料枠 | パフォーマンス | 適用時期 |
|----------|----------|------------|--------|---------------|----------|
| **D1 Database (Cloudflare)** | **エッジ配置、超高速、SQLite互換、無料枠大** | **機能制限、新しいサービス、分析クエリ弱** | **25GB** | **★★★** | **MVP期** |
| Neon PostgreSQL | Serverless、ブランチング、自動スケール | 新しい、制限あり、レイテンシ | 3GB | ★★ | 成長期 |
| PlanetScale MySQL | ブランチング、自動スケール、企業実績 | 高コスト、MySQL制約 | 10GB | ★★ | スケール期 |
| Railway PostgreSQL | 統合管理、シンプル設定、自動バックアップ | 単一AZ、制限あり | $5クレジット分 | ★★ | 安定期 |

**選定結果**: **D1 Database**（Cloudflare Workers統合）

**選定理由**: SQLite互換でシンプル、25GB無料枠、エッジ配置による高速アクセス

### 開発ツール（Linting・フォーマット）

| ツール | メリット | デメリット | 適用場面 | TypeScript統合 | 学習コスト | 判定 |
|--------|----------|------------|----------|---------------|-----------|------|
| **Biome** | **Rust製高速、Lint+Format統合、TypeScript最適、設定シンプル** | **新しい技術、プラグイン少、移行コスト** | **TypeScript中心、高速化重視、設定簡素化** | **★★★** | **低** | **○** |
| ESLint + Prettier | 成熟、プラグイン豊富、カスタマイズ性、実績多数 | 設定複雑、実行速度、依存関係多 | カスタマイズ重視、プラグイン活用、既存プロジェクト | ★★ | 中 | △ |

**選定結果**: Biome

**選定理由**: TypeScript開発体験の最適化、設定の単純化、100ms要件に向けた高速処理

### CI/CD・デプロイメント

#### CI/CDプラットフォーム選定

| プラットフォーム | メリット | デメリット | 適用場面 | コスト | 設定容易さ | 判定 |
|------------------|----------|------------|----------|--------|------------|------|
| **GitHub Actions** | **GitHub統合、YAML設定、豊富なAction、無料枠充実** | **実行時間制限、複雑ワークフロー管理困難** | **OSS・小中規模、GitHub中心開発** | **低** | **高** | **○** |
| CircleCI | 高機能、Docker最適化、並列実行、企業実績 | 設定複雑、コスト高、学習コスト | 大規模、Docker中心、CI/CD特化 | 高 | 中 | △ |
| GitLab CI | GitLab統合、Runner自由度、企業機能充実 | GitLab依存、設定複雑、運用負荷 | GitLab中心、セルフホスト、企業向け | 中 | 中 | × |

**選定結果**: GitHub Actions

**選定理由**:

1. GitHub中心の開発フローとの統合
2. Vercel・Cloudflare Workers自動デプロイとの親和性
3. 小規模チームでの運用負荷軽減

#### E2Eテストフレームワーク

**選定理由**: PWA・Next.js環境でのクロスブラウザE2Eテスト、CI/CD統合のため

| フレームワーク | 特徴 | 採用理由 |
| --- | --- | --- |
| Playwright | モダンなWeb自動化、クロスブラウザ対応、TypeScriptサポート | Next.jsやPWAとの親和性、CI/CD統合が容易 |
| Cypress | 高速なローカル実行、豊富なコミュニティ | UIテストの記述が直感的、学習コストが低い |
| TestCafe | インストール不要、Node.jsベース | シンプルなセットアップ、複数ブラウザ対応 |

**選定結果**: Playwright
**選定理由**:

- Next.jsやPWA環境との高い互換性
- TypeScriptによる型安全なテスト記述
- CI/CD（GitHub Actions）との統合が容易

## まとめ

### 採用技術スタック

**フロントエンド**:

- Framework: Next.js 15 (App Router)
- Styling: Tailwind CSS
- State: Zustand
- Language: TypeScript

**バックエンド**:

- Framework: Hono
- Database: SQLite → PostgreSQL
- ORM: Drizzle ORM
- Language: TypeScript

**インフラ・運用**:

- Frontend Hosting: Vercel
- Backend Hosting: Cloudflare Workers
- Database: D1 Database
- CI/CD: GitHub Actions
- Linting: Biome

### アーキテクチャ整合性確認

- ✅ モジュラーモノリス: 単一リポジトリ、境界明確なモジュール構成
- ✅ ヘキサゴナルアーキテクチャ: Drizzle ORMによるリポジトリパターン実装
- ✅ TypeScript統一: フロントエンド・バックエンド全体での型安全性
- ✅ パフォーマンス要件: Hono + Cloudflare Workers エッジ実行による100ms要件対応
- ✅ PWA対応: Next.js + Vercelによるオフライン機能実装
- ✅ 費用効率: Cloudflare Workers（100,000req/日無料）+ D1 Database（25GB無料）
- ✅ 運用シンプル: 単一プラットフォーム（Cloudflare）で完結
