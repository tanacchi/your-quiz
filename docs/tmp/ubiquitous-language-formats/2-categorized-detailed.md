# 案2: カテゴリ分類詳細型

## フォーマット概要

ドメイン概念をカテゴリ別に分類し、詳細な説明・制約・BDD表現・TypeScript型定義を含む包括的な管理形式。実装時の参照性とドメイン理解の深さを重視。

## 構成

```markdown
# ユビキタス言語辞書

## カテゴリ別用語集

### 1. エンティティ（Entity）
### 2. 値オブジェクト（Value Object）
### 3. ドメインサービス（Domain Service）
### 4. 集約（Aggregate）
### 5. ユーザー操作（User Action）
### 6. システム状態（System State）
### 7. UI表現（UI Expression）

各カテゴリで以下の形式：

#### [概念名]
- **日本語**: [日本語表記]
- **英語**: [English]
- **変数名**: [variableName]
- **TypeScript型**: [TypeName]
- **定義**: [詳細な定義説明]
- **制約・ルール**: [ビジネスルール]
- **BDD表現**: [Gherkin形式の表現例]
- **関連概念**: [他の概念との関係]
```

## サンプル実装

```markdown
# ユビキタス言語辞書

## カテゴリ別用語集

### 1. エンティティ（Entity）

#### クイズ
- **日本語**: クイズ
- **英語**: Quiz
- **変数名**: quiz
- **TypeScript型**: Quiz
- **定義**: 問題文・正解・解説・タグ・承認状態を持つ◯×形式の学習問題。システムの中核となるビジネスオブジェクト
- **制約・ルール**: 
  - 問題文は必須・500文字以内
  - 正解は◯×の2択必須
  - 解説は任意・1000文字以内
  - 管理者承認後のみ一般公開
- **BDD表現**: 
  - `Given クイズが承認済みである`
  - `When ユーザーがクイズに回答する`
  - `Then クイズの解説が表示される`
- **関連概念**: Creator（作成者）、Approval（承認）、Answer（回答）

#### 作成者
- **日本語**: 作成者
- **英語**: Creator
- **変数名**: creator
- **TypeScript型**: Creator
- **定義**: salt付きハッシュで識別される匿名のクイズ投稿者。ログイン不要でクイズ作成が可能
- **制約・ルール**:
  - 匿名識別（salt付きハッシュ使用）
  - 同一問題の重複投稿許可
  - ブラウザベースの識別情報保存
- **BDD表現**:
  - `Given 作成者が存在する`
  - `When 作成者がクイズを投稿する`
  - `Then 作成者識別情報が保存される`
- **関連概念**: Quiz（クイズ）、CreatorIdentification（作成者識別情報）

### 2. 値オブジェクト（Value Object）

#### 問題文
- **日本語**: 問題文
- **英語**: Question
- **変数名**: question
- **TypeScript型**: Question
- **定義**: ユーザーが◯×判断を行う対象となる500文字以内のプレーンテキスト
- **制約・ルール**:
  - 必須項目
  - 500文字以内
  - HTMLタグはサニタイズ処理
  - 空文字・空白のみは無効
- **BDD表現**:
  - `Given 問題文が入力されている`
  - `When 問題文が表示される`
  - `Then 問題文が500文字以内である`
- **関連概念**: Quiz（クイズ）、Sanitization（サニタイズ処理）

#### タグ
- **日本語**: タグ
- **英語**: Tag
- **変数名**: tag
- **TypeScript型**: Tag
- **定義**: 日本語・英数字に対応したクイズ分類用のラベル。複数設定可能で絞り込み検索に使用
- **制約・ルール**:
  - 任意項目（複数設定可）
  - 日本語・半角全角英数字対応
  - 空タグは無効
  - 重複タグは除去
- **BDD表現**:
  - `Given タグが設定されている`
  - `When ユーザーがタグで絞り込む`
  - `Then タグに一致するクイズが表示される`
- **関連概念**: Quiz（クイズ）、Filter（絞り込み）

### 3. ドメインサービス（Domain Service）

#### 承認
- **日本語**: 承認
- **英語**: Approval
- **変数名**: approval
- **TypeScript型**: ApprovalService
- **定義**: 管理者による投稿クイズの公開可否判定プロセス。内容適切性と重複チェックを実行
- **制約・ルール**:
  - 管理者権限必須
  - 承認前は非公開
  - 承認後は一般ユーザーに公開
  - 拒否理由の記録
- **BDD表現**:
  - `Given 承認が完了している`
  - `When 管理者がクイズを承認する`
  - `Then クイズが承認済み状態になる`
- **関連概念**: Quiz（クイズ）、Administrator（管理者）、PendingApproval（承認待ち）

### 4. 集約（Aggregate）

#### 学習セッション
- **日本語**: 学習セッション
- **英語**: LearningSession
- **変数名**: learningSession
- **TypeScript型**: LearningSession
- **定義**: ユーザーの一連のクイズ回答活動。回答履歴と学習進捗を管理する集約ルート
- **制約・ルール**:
  - ユーザー単位でのセッション管理
  - 回答履歴の永続化
  - オフライン対応必須
  - 同期処理による整合性保証
- **BDD表現**:
  - `Given 学習セッションが開始されている`
  - `When ユーザーが回答を完了する`
  - `Then 学習セッションに記録される`
- **関連概念**: Answer（回答）、AnswerHistory（回答履歴）、Sync（同期）

### 5. ユーザー操作（User Action）

#### 右スワイプ
- **日本語**: 右スワイプ
- **英語**: SwipeRight
- **変数名**: swipeRight
- **TypeScript型**: SwipeRightAction
- **定義**: ◯選択を意味する右方向のスワイプ操作。Tinder UI形式の直感的入力方法
- **制約・ルール**:
  - タッチデバイスでのスワイプ検出
  - 一定距離以上の移動で有効
  - 右方向（正の値）の判定
  - 回答の即座実行
- **BDD表現**:
  - `When ユーザーが右スワイプする`
  - `Then ◯として回答が記録される`
  - `And 正誤判定が表示される`
- **関連概念**: Answer（回答）、SwipeLeft（左スワイプ）、CorrectJudgment（正誤判定）

#### 左スワイプ
- **日本語**: 左スワイプ
- **英語**: SwipeLeft
- **変数名**: swipeLeft
- **TypeScript型**: SwipeLeftAction
- **定義**: ×選択を意味する左方向のスワイプ操作。Tinder UI形式の直感的入力方法
- **制約・ルール**:
  - タッチデバイスでのスワイプ検出
  - 一定距離以上の移動で有効
  - 左方向（負の値）の判定
  - 回答の即座実行
- **BDD表現**:
  - `When ユーザーが左スワイプする`
  - `Then ×として回答が記録される`
  - `And 正誤判定が表示される`
- **関連概念**: Answer（回答）、SwipeRight（右スワイプ）、CorrectJudgment（正誤判定）

### 6. システム状態（System State）

#### 承認待ち
- **日本語**: 承認待ち
- **英語**: PendingApproval
- **変数名**: pendingApproval
- **TypeScript型**: PendingApprovalState
- **定義**: 投稿されたクイズが管理者による承認を待っている状態。一般ユーザーには非表示
- **制約・ルール**:
  - 投稿直後の初期状態
  - 一般ユーザーからは非表示
  - 管理者のみ確認・操作可能
  - 承認・拒否のどちらかに遷移
- **BDD表現**:
  - `Given クイズが承認待ち状態である`
  - `When 管理者が承認処理を行う`
  - `Then 状態が承認済みまたは承認拒否に変更される`
- **関連概念**: Approval（承認）、Approved（承認済み）、Rejected（承認拒否）

#### オフラインモード
- **日本語**: オフラインモード
- **英語**: OfflineMode
- **変数名**: offlineMode
- **TypeScript型**: OfflineModeState
- **定義**: ネットワーク断線時に事前ダウンロード済みデータで動作する状態
- **制約・ルール**:
  - 事前ダウンロードデータ必須
  - 新規データ取得不可
  - 回答データのローカル保存
  - オンライン復旧時の自動同期
- **BDD表現**:
  - `Given アプリがオフラインモードである`
  - `When ユーザーがクイズに回答する`
  - `Then 回答がローカルに保存される`
- **関連概念**: Sync（同期）、AnswerHistory（回答履歴）

### 7. UI表現（UI Expression）

#### バン表示
- **日本語**: バン表示
- **英語**: ShowBanner
- **変数名**: showBanner
- **TypeScript型**: ShowBannerEffect
- **定義**: 正誤判定結果を画面に大きく即座表示するUI効果
- **制約・ルール**:
  - 回答直後の即座表示
  - 正解・不正解の明確な区別
  - 視覚的インパクト重視
  - フェードアウトへの自動遷移
- **BDD表現**:
  - `Then 正誤判定がバン表示される`
  - `And 正解または不正解が明確に示される`
  - `And 2秒後にフェードアウトする`
- **関連概念**: CorrectJudgment（正誤判定）、FadeOut（フェードアウト）

#### フェードアウト
- **日本語**: フェードアウト
- **英語**: FadeOut
- **変数名**: fadeOut
- **TypeScript型**: FadeOutEffect
- **定義**: UI要素が徐々に透明になって消える視覚効果
- **制約・ルール**:
  - バン表示後の自動実行
  - 1-2秒での段階的透明化
  - 完全消去後に次画面表示
  - アニメーション中の操作無効化
- **BDD表現**:
  - `Then バンがフェードアウトする`
  - `And 解説画面が表示される`
  - `And 次の問題ボタンが有効になる`
- **関連概念**: ShowBanner（バン表示）、Explanation（解説）

## 参照・検索インデックス

### 日本語→英語索引
- 承認 → Approval
- 承認待ち → PendingApproval
- クイズ → Quiz
- 作成者 → Creator
- 右スワイプ → SwipeRight

### 英語→TypeScript型索引
- Quiz → Quiz
- Creator → Creator
- Approval → ApprovalService
- SwipeRight → SwipeRightAction
- PendingApproval → PendingApprovalState

### BDD表現索引
- Given句で使用: "クイズが承認済みである", "作成者が存在する"
- When句で使用: "ユーザーが右スワイプする", "管理者が承認する"
- Then句で使用: "正誤判定が表示される", "バンがフェードアウトする"
```

## 利点・欠点

### 利点
- ✅ **構造化**: カテゴリ分類で理解しやすい
- ✅ **実装支援**: TypeScript型とBDD表現の明示
- ✅ **詳細情報**: 制約・ルール・関連概念まで記載
- ✅ **検索性**: 各種インデックスで参照が容易

### 欠点
- ❌ **文書量大**: 詳細記載で文書が肥大化
- ❌ **メンテナンス負荷**: 複数箇所の更新が必要
- ❌ **複雑性**: 初見者には情報過多の可能性

## 適用場面
- 複雑なドメインで詳細な定義が必要
- TypeScript実装とBDDテストを並行開発
- チーム人数が多く、詳細な仕様共有が重要
- 長期メンテナンスでドキュメント品質を重視