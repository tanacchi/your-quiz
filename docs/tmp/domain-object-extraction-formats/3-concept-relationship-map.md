# æ¡ˆ3: æ¦‚å¿µãƒãƒƒãƒ—å‹

## ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¦‚è¦

ãƒ‰ãƒ¡ã‚¤ãƒ³æ¦‚å¿µã‚’ä¸­å¿ƒã«ç½®ãã€æ¦‚å¿µé–“ã®é–¢ä¿‚æ€§ï¼ˆis-a, has-a, uses, createsç­‰ï¼‰ã‚’ãƒãƒƒãƒ—å½¢å¼ã§å¯è¦–åŒ–ã—ã¦ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã€‚æ¦‚å¿µã®éšå±¤æ§‹é€ ã¨ä¾å­˜é–¢ä¿‚ã‚’æ˜ç¢ºåŒ–ã—ã€é–¢ä¿‚æ€§ã‹ã‚‰è‡ªç„¶ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å€™è£œã‚’ç‰¹å®šã€‚

## æ§‹æˆ

```markdown
# ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŠ½å‡ºãƒ»åˆ†æï¼ˆæ¦‚å¿µãƒãƒƒãƒ—å‹ï¼‰

## æ¦‚å¿µæŠ½å‡º
### specificationsåˆ†æã‹ã‚‰ã®æ¦‚å¿µãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
### æ¦‚å¿µã®åˆæœŸåˆ†é¡ï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å€™è£œãƒ»å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå€™è£œãƒ»ã‚µãƒ¼ãƒ“ã‚¹å€™è£œï¼‰

## æ¦‚å¿µé–¢ä¿‚ãƒãƒƒãƒ—
### é–¢ä¿‚æ€§ã®åˆ†é¡ï¼ˆåŒ…å«ãƒ»å‚ç…§ãƒ»ä½œæˆãƒ»ä½¿ç”¨ãƒ»ç¶™æ‰¿ç­‰ï¼‰
### Mermaidå›³ã«ã‚ˆã‚‹é–¢ä¿‚æ€§å¯è¦–åŒ–

## æ¦‚å¿µéšå±¤åˆ†æ
### æŠ½è±¡åº¦ãƒ¬ãƒ™ãƒ«åˆ¥ã®æ¦‚å¿µæ•´ç†
### æ¦‚å¿µã®ä¾å­˜æ–¹å‘ãƒ»åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼

## ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«å¸°å±åˆ†æ
### æ¦‚å¿µåˆ¥ã®è²¬ä»»ãƒ»åˆ¶ç´„ã®ç‰¹å®š
### é–¢ä¿‚æ€§ã‹ã‚‰è¦‹ãˆã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å€™è£œ

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹æŠ½å‡º
### æ¦‚å¿µé–“å”èª¿ãŒå¿…è¦ãªå‡¦ç†ã®ç‰¹å®š
### ã‚µãƒ¼ãƒ“ã‚¹å€™è£œã®è²¬ä»»ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
```

## ã‚µãƒ³ãƒ—ãƒ«å®Ÿè£…

```markdown
# ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŠ½å‡ºãƒ»åˆ†æï¼ˆæ¦‚å¿µãƒãƒƒãƒ—å‹ï¼‰

## æ¦‚å¿µæŠ½å‡º

### specificationsåˆ†æã‹ã‚‰ã®æ¦‚å¿µãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
**åˆ†æå¯¾è±¡**: user-stories, requirements, success-scenarios

| æ¦‚å¿µå | ç™ºè¦‹ç®‡æ‰€ | åˆæœŸç†è§£ | é–¢ä¿‚æ€§ãƒ’ãƒ³ãƒˆ | æŠ½è±¡åº¦ |
|--------|----------|----------|-------------|--------|
| **Quiz** | user-story#L11 | â—¯Ã—å½¢å¼ã®å•é¡Œ | ä½œæˆè€…ãƒ»å›ç­”è€…ãƒ»æ‰¿èªè€…ã¨é–¢ä¿‚ | ğŸ”´ é«˜ |
| **Question** | requirements#L11 | 500æ–‡å­—ä»¥å†…ã®å•é¡Œæ–‡ | Quizã«åŒ…å«ã•ã‚Œã‚‹ | ğŸŸ¡ ä¸­ |
| **Creator** | user-story#L18 | ã‚¯ã‚¤ã‚ºä½œæˆè€… | Quizã‚’ä½œæˆã™ã‚‹ | ğŸ”´ é«˜ |
| **User** | user-story#L5 | åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ | Quizã«å›ç­”ã™ã‚‹ | ğŸ”´ é«˜ |
| **Administrator** | user-story#L6 | ç®¡ç†è€… | Quizã‚’æ‰¿èªã™ã‚‹ | ğŸ”´ é«˜ |
| **Answer** | success#L20 | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›ç­” | Quizãƒ»Userã¨é–¢ä¿‚ | ğŸ”´ é«˜ |
| **CorrectAnswer** | requirements#L12 | â—¯Ã—ã®æ­£è§£ | Quizã«åŒ…å«ã€Answerã¨æ¯”è¼ƒ | ğŸŸ¡ ä¸­ |
| **Explanation** | requirements#L13 | è§£èª¬æ–‡ | Quizã«åŒ…å« | ğŸŸ¡ ä¸­ |
| **Tag** | requirements#L14 | åˆ†é¡ãƒ©ãƒ™ãƒ« | Quizã¨å¤šå¯¾å¤šé–¢ä¿‚ | ğŸŸ¡ ä¸­ |
| **Approval** | requirements#L20 | æ‰¿èªå‡¦ç† | Quizãƒ»AdministratorãŒé–¢ä¸ | ğŸŸ¢ ä½ |
| **SwipeGesture** | success#L15 | ã‚¹ãƒ¯ã‚¤ãƒ—æ“ä½œ | Answerã‚’ä½œæˆã™ã‚‹ | ğŸŸ¢ ä½ |
| **AnswerHistory** | success#L24 | å›ç­”å±¥æ­´ | Answerã‚’é›†ç´„ | ğŸŸ¡ ä¸­ |
| **Session** | success#L70 | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ | Userãƒ»Answerã‚’ç®¡ç† | ğŸŸ¡ ä¸­ |

### æ¦‚å¿µã®åˆæœŸåˆ†é¡
**ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å€™è£œ** (é«˜æŠ½è±¡åº¦ãƒ»ç‹¬ç«‹æ€§ã‚ã‚Š):
- Quiz, Creator, User, Administrator, Answer, Session

**å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå€™è£œ** (ä¸­æŠ½è±¡åº¦ãƒ»åŒ…å«é–¢ä¿‚):
- Question, CorrectAnswer, Explanation, Tag

**ã‚µãƒ¼ãƒ“ã‚¹å€™è£œ** (ä½æŠ½è±¡åº¦ãƒ»å‡¦ç†ä¸­å¿ƒ):
- Approval, SwipeGesture, AnswerHistoryï¼ˆé›†ç´„å€™è£œã§ã‚‚ã‚ã‚‹ï¼‰

## æ¦‚å¿µé–¢ä¿‚ãƒãƒƒãƒ—

### é–¢ä¿‚æ€§ã®åˆ†é¡

#### åŒ…å«é–¢ä¿‚ (has-a / contains)
```mermaid
graph TD
    Quiz -->|contains| Question
    Quiz -->|contains| CorrectAnswer
    Quiz -->|contains| Explanation
    Quiz -->|tagged with| Tag
    Session -->|contains| AnswerHistory
    AnswerHistory -->|aggregates| Answer
```

#### ä½œæˆé–¢ä¿‚ (creates / produces)
```mermaid
graph TD
    Creator -->|creates| Quiz
    User -->|performs| SwipeGesture
    SwipeGesture -->|creates| Answer
    Administrator -->|performs| Approval
    Approval -->|produces| ApprovalResult
```

#### å‚ç…§é–¢ä¿‚ (references / uses)
```mermaid
graph TD
    Answer -->|references| Quiz
    Answer -->|belongs to| Session
    Approval -->|evaluates| Quiz
    Quiz -->|belongs to| Creator
    Session -->|identifies| User
```

#### ç¶™æ‰¿é–¢ä¿‚ (is-a)
```mermaid
graph TD
    Creator -.->|is-a| User
    Administrator -.->|is-a| User
    
    %% å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹éšå±¤
    TextContent -.->|specialized by| Question
    TextContent -.->|specialized by| Explanation
    Identifier -.->|specialized by| CreatorId
    Identifier -.->|specialized by| QuizId
```

### çµ±åˆæ¦‚å¿µé–¢ä¿‚ãƒãƒƒãƒ—
```mermaid
graph TB
    %% é«˜æŠ½è±¡åº¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
    User[User<br/>åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼]
    Creator[Creator<br/>ä½œæˆè€…]
    Administrator[Administrator<br/>ç®¡ç†è€…]
    Quiz[Quiz<br/>ã‚¯ã‚¤ã‚º]
    Answer[Answer<br/>å›ç­”]
    Session[Session<br/>ã‚»ãƒƒã‚·ãƒ§ãƒ³]
    
    %% ä¸­æŠ½è±¡åº¦å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    Question[Question<br/>å•é¡Œæ–‡]
    CorrectAnswer[CorrectAnswer<br/>æ­£è§£]
    Explanation[Explanation<br/>è§£èª¬]
    Tag[Tag<br/>ã‚¿ã‚°]
    AnswerHistory[AnswerHistory<br/>å›ç­”å±¥æ­´]
    
    %% ä½æŠ½è±¡åº¦ã‚µãƒ¼ãƒ“ã‚¹ãƒ»æ“ä½œ
    SwipeGesture[SwipeGesture<br/>ã‚¹ãƒ¯ã‚¤ãƒ—æ“ä½œ]
    Approval[Approval<br/>æ‰¿èªå‡¦ç†]
    
    %% é–¢ä¿‚æ€§
    Creator -.->|is-a| User
    Administrator -.->|is-a| User
    
    Creator -->|creates| Quiz
    Quiz -->|contains| Question
    Quiz -->|contains| CorrectAnswer
    Quiz -->|contains| Explanation
    Quiz -->|tagged with| Tag
    
    User -->|performs| SwipeGesture
    SwipeGesture -->|creates| Answer
    Answer -->|references| Quiz
    Answer -->|belongs to| Session
    
    Administrator -->|performs| Approval
    Approval -->|evaluates| Quiz
    
    Session -->|manages| AnswerHistory
    AnswerHistory -->|aggregates| Answer
    Session -->|identifies| User
```

## æ¦‚å¿µéšå±¤åˆ†æ

### æŠ½è±¡åº¦ãƒ¬ãƒ™ãƒ«åˆ¥ã®æ¦‚å¿µæ•´ç†

#### Level 3: é«˜æŠ½è±¡åº¦ï¼ˆãƒ“ã‚¸ãƒã‚¹æ¦‚å¿µãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼‰
| æ¦‚å¿µ | è²¬ä»» | ç‹¬ç«‹æ€§ | ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« |
|------|------|--------|---------------|
| **Quiz** | å•é¡Œæç¤ºãƒ»æ­£èª¤åˆ¤å®šãƒ»çŠ¶æ…‹ç®¡ç† | âœ… é«˜ | æŠ•ç¨¿â†’æ‰¿èªâ†’å…¬é–‹â†’å‰Šé™¤ |
| **User** | ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨ãƒ»æ“ä½œå®Ÿè¡Œ | âœ… é«˜ | ã‚¢ã‚¯ã‚»ã‚¹â†’æ“ä½œâ†’é›¢è„± |
| **Creator** | ã‚¯ã‚¤ã‚ºä½œæˆãƒ»æŠ•ç¨¿ | âœ… é«˜ | è­˜åˆ¥â†’ä½œæˆâ†’æŠ•ç¨¿ç¶™ç¶š |
| **Administrator** | ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ãƒ»æ‰¿èªå‡¦ç† | âœ… é«˜ | ãƒ­ã‚°ã‚¤ãƒ³â†’æ‰¿èªæ¥­å‹™â†’ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ |
| **Answer** | å›ç­”è¨˜éŒ²ãƒ»çµ±è¨ˆç”Ÿæˆ | âœ… é«˜ | ä½œæˆâ†’è¨˜éŒ²â†’çµ±è¨ˆé›†ç´„ |
| **Session** | ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ»è­˜åˆ¥ | âœ… é«˜ | é–‹å§‹â†’ç¶™ç¶šâ†’çµ‚äº†ãƒ»åŒæœŸ |

#### Level 2: ä¸­æŠ½è±¡åº¦ï¼ˆå€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ»é›†ç´„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
| æ¦‚å¿µ | è²¬ä»» | è¦ªã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|------|------|-------------|---------------|
| **Question** | å•é¡Œæ–‡è¡¨ç¾ãƒ»åˆ¶ç´„ä¿è¨¼ | Quiz | 500æ–‡å­—åˆ¶é™ãƒ»ã‚µãƒ‹ã‚¿ã‚¤ã‚º |
| **CorrectAnswer** | æ­£è§£è¡¨ç¾ãƒ»æ¯”è¼ƒå‡¦ç† | Quiz | â—¯Ã—ã®2æŠåˆ¶ç´„ |
| **Explanation** | è§£èª¬è¡¨ç¾ãƒ»è¡¨ç¤ºåˆ¶å¾¡ | Quiz | 1000æ–‡å­—åˆ¶é™ãƒ»ä»»æ„ |
| **Tag** | åˆ†é¡è¡¨ç¾ãƒ»æ¤œç´¢æ”¯æ´ | Quizï¼ˆå¤šå¯¾å¤šï¼‰ | æ­£è¦åŒ–ãƒ»é‡è¤‡æ’é™¤ |
| **AnswerHistory** | å±¥æ­´ç®¡ç†ãƒ»çµ±è¨ˆè¨ˆç®— | Session | æ°¸ç¶šåŒ–ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ |

#### Level 1: ä½æŠ½è±¡åº¦ï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ»æ“ä½œãƒ»UIï¼‰
| æ¦‚å¿µ | è²¬ä»» | ãƒˆãƒªã‚¬ãƒ¼ | çµæœ |
|------|------|----------|------|
| **SwipeGesture** | ã‚¹ãƒ¯ã‚¤ãƒ—æ¤œå‡ºãƒ»å›ç­”å¤‰æ› | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ | Answerç”Ÿæˆ |
| **Approval** | æ‰¿èªåˆ¤å®šãƒ»çŠ¶æ…‹å¤‰æ›´ | ç®¡ç†è€…æ“ä½œ | QuizçŠ¶æ…‹æ›´æ–° |
| **Filter** | çµã‚Šè¾¼ã¿å‡¦ç†ãƒ»çµæœç”Ÿæˆ | æ¤œç´¢è¦æ±‚ | çµã‚Šè¾¼ã¿çµæœ |
| **Sync** | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åŒæœŸãƒ»æ•´åˆæ€§ä¿è¨¼ | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¾©æ—§ | ãƒ‡ãƒ¼ã‚¿çµ±åˆ |

### æ¦‚å¿µã®ä¾å­˜æ–¹å‘ãƒ»åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼

#### ä¾å­˜æ–¹å‘ï¼ˆä¸Šä½â†’ä¸‹ä½ï¼‰
```
Level 3 (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£) â†’ Level 2 (å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ) â†’ Level 1 (ã‚µãƒ¼ãƒ“ã‚¹ãƒ»æ“ä½œ)
```

#### åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ä¾‹ï¼ˆã‚¯ã‚¤ã‚ºå›ç­”ï¼‰
```
User â†’ SwipeGesture â†’ Answer â†’ Quiz â†’ CorrectAnswer â†’ Session â†’ AnswerHistory
```

**åˆ¶å¾¡ã®æµã‚Œ**:
1. Userï¼ˆL3ï¼‰ãŒSwipeGestureï¼ˆL1ï¼‰ã‚’å®Ÿè¡Œ
2. SwipeGestureãŒAnswerï¼ˆL3ï¼‰ã‚’ç”Ÿæˆ
3. AnswerãŒQuizï¼ˆL3ï¼‰ã®CorrectAnswerï¼ˆL2ï¼‰ã¨æ¯”è¼ƒ
4. çµæœãŒSessionï¼ˆL3ï¼‰ã®AnswerHistoryï¼ˆL2ï¼‰ã«è¨˜éŒ²

## ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«å¸°å±åˆ†æ

### æ¦‚å¿µåˆ¥ã®è²¬ä»»ãƒ»åˆ¶ç´„ã®ç‰¹å®š

#### Quizï¼ˆã‚¯ã‚¤ã‚ºï¼‰
**æ‰€æœ‰ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**:
- **å†…å®¹åˆ¶ç´„**: Question(500æ–‡å­—)ã€Explanation(1000æ–‡å­—)
- **å½¢å¼åˆ¶ç´„**: CorrectAnswer(â—¯Ã—ã®ã¿)
- **å“è³ªåˆ¶ç´„**: æ‰¿èªå¿…é ˆã€ã‚µãƒ‹ã‚¿ã‚¤ã‚ºå‡¦ç†
- **å…¬é–‹åˆ¶ç´„**: æ‰¿èªæ¸ˆã¿ã®ã¿å›ç­”å¯èƒ½

**é–¢ä¿‚æ€§ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹è²¬ä»»**:
- Creator â†’ Quiz: ä½œæˆè€…ã®æŠ•ç¨¿æ¨©é™ç®¡ç†
- Quiz â†’ Tag: åˆ†é¡æ•´åˆæ€§ã®ä¿è¨¼
- Quiz â†’ Answer: å›ç­”å¯èƒ½çŠ¶æ…‹ã®åˆ¶å¾¡

#### Answerï¼ˆå›ç­”ï¼‰
**æ‰€æœ‰ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**:
- **è¨˜éŒ²åˆ¶ç´„**: å¿…é ˆé …ç›®ï¼ˆQuizå‚ç…§ã€æ­£èª¤ã€æ™‚åˆ»ï¼‰
- **å±¥æ­´åˆ¶ç´„**: æ°¸ç¶šåŒ–ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·
- **çµ±è¨ˆåˆ¶ç´„**: é›†è¨ˆå¯èƒ½æ€§ã€åŒ¿åæ€§

**é–¢ä¿‚æ€§ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹è²¬ä»»**:
- SwipeGesture â†’ Answer: æ“ä½œã®æ­£ç¢ºãªå¤‰æ›
- Answer â†’ Quiz: æ‰¿èªæ¸ˆã¿ã‚¯ã‚¤ã‚ºã®ã¿å›ç­”
- Answer â†’ Session: ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•´åˆæ€§ä¿è¨¼

#### Sessionï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰
**æ‰€æœ‰ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«**:
- **è­˜åˆ¥åˆ¶ç´„**: åŒ¿åãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä¸€æ„è­˜åˆ¥
- **ç¶™ç¶šåˆ¶ç´„**: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç¶™ç¶šã€è‡ªå‹•åŒæœŸ
- **å±¥æ­´åˆ¶ç´„**: å›ç­”å±¥æ­´ã®é›†ç´„ç®¡ç†

**é–¢ä¿‚æ€§ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹è²¬ä»»**:
- User â†’ Session: åŒ¿åè­˜åˆ¥ã®ä¿¡é ¼æ€§
- Session â†’ AnswerHistory: å±¥æ­´å®Œå…¨æ€§ä¿è¨¼
- Session â†’ Sync: åŒæœŸã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆ¶å¾¡

### é–¢ä¿‚æ€§ã‹ã‚‰è¦‹ãˆã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å€™è£œ

#### æ¦‚å¿µé–“å”èª¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰ã®æŠ½å‡º

##### ãƒ‘ã‚¿ãƒ¼ãƒ³1: Quizä½œæˆ-æ‰¿èªå”èª¿
```
Creator â†’ Quiz â†’ Approval â†’ Administrator
```
**æŠ½å‡ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹**: `QuizApprovalService`
- è²¬ä»»: æ‰¿èªãƒ•ãƒ­ãƒ¼åˆ¶å¾¡ã€æ‰¿èªåŸºæº–é©ç”¨ã€çŠ¶æ…‹é·ç§»ç®¡ç†
- å”èª¿ã™ã‚‹æ¦‚å¿µ: Quiz, Approval, Administrator, ApprovalHistory

##### ãƒ‘ã‚¿ãƒ¼ãƒ³2: å›ç­”-åˆ¤å®š-è¨˜éŒ²å”èª¿
```
SwipeGesture â†’ Answer â†’ Quiz â†’ Session
```
**æŠ½å‡ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹**: `AnswerProcessingService`
- è²¬ä»»: å›ç­”å‡¦ç†ã€æ­£èª¤åˆ¤å®šã€å±¥æ­´è¨˜éŒ²ã€çµ±è¨ˆæ›´æ–°
- å”èª¿ã™ã‚‹æ¦‚å¿µ: SwipeGesture, Answer, Quiz, Session, AnswerHistory

##### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚»ãƒƒã‚·ãƒ§ãƒ³-åŒæœŸå”èª¿
```
Session â†’ AnswerHistory â†’ Sync â†’ RemoteStorage
```
**æŠ½å‡ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹**: `SessionSyncService`
- è²¬ä»»: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³-ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åŒæœŸã€ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã€ç«¶åˆè§£æ±º
- å”èª¿ã™ã‚‹æ¦‚å¿µ: Session, AnswerHistory, OfflineStorage, RemoteStorage

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹æŠ½å‡º

### æ¦‚å¿µé–“å”èª¿ãŒå¿…è¦ãªå‡¦ç†ã®ç‰¹å®š

#### 1. QuizApprovalServiceï¼ˆã‚¯ã‚¤ã‚ºæ‰¿èªã‚µãƒ¼ãƒ“ã‚¹ï¼‰
**å”èª¿ã™ã‚‹æ¦‚å¿µ**:
- Quiz: æ‰¿èªå¯¾è±¡ã®å–å¾—ãƒ»çŠ¶æ…‹æ›´æ–°
- Administrator: æ‰¿èªè€…ã®æ¨©é™ç¢ºèª
- ApprovalCriteria: æ‰¿èªåŸºæº–ã®é©ç”¨
- ApprovalHistory: æ‰¿èªå±¥æ­´ã®è¨˜éŒ²

**è²¬ä»»**:
```typescript
interface QuizApprovalService {
  // æ‰¿èªåŸºæº–ãƒã‚§ãƒƒã‚¯
  checkApprovalCriteria(quiz: Quiz): ApprovalCriteria;
  
  // æ‰¿èªå®Ÿè¡Œ
  approveQuiz(quizId: QuizId, administrator: Administrator, reason?: string): ApprovalResult;
  
  // æ‰¿èªæ‹’å¦
  rejectQuiz(quizId: QuizId, administrator: Administrator, reason: string): ApprovalResult;
  
  // æ‰¿èªå±¥æ­´å–å¾—
  getApprovalHistory(quizId: QuizId): ApprovalHistory[];
}
```

#### 2. AnswerProcessingServiceï¼ˆå›ç­”å‡¦ç†ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
**å”èª¿ã™ã‚‹æ¦‚å¿µ**:
- SwipeGesture: æ“ä½œã®è§£é‡ˆãƒ»å¤‰æ›
- Answer: å›ç­”ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆ
- Quiz: æ­£èª¤åˆ¤å®šã®å®Ÿè¡Œ
- Session: å±¥æ­´ã¸ã®è¨˜éŒ²
- Statistics: çµ±è¨ˆæƒ…å ±ã®æ›´æ–°

**è²¬ä»»**:
```typescript
interface AnswerProcessingService {
  // ã‚¹ãƒ¯ã‚¤ãƒ—æ“ä½œã‹ã‚‰å›ç­”å‡¦ç†
  processSwipeAnswer(gesture: SwipeGesture, quiz: Quiz, session: Session): AnswerResult;
  
  // æ­£èª¤åˆ¤å®šå®Ÿè¡Œ
  judgeAnswer(userAnswer: boolean, quiz: Quiz): JudgmentResult;
  
  // å±¥æ­´è¨˜éŒ²
  recordAnswer(answer: Answer, session: Session): void;
  
  // çµ±è¨ˆæ›´æ–°
  updateStatistics(session: Session): Statistics;
}
```

#### 3. CreatorIdentificationServiceï¼ˆä½œæˆè€…è­˜åˆ¥ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
**å”èª¿ã™ã‚‹æ¦‚å¿µ**:
- Creator: ä½œæˆè€…ã®è­˜åˆ¥ãƒ»ç®¡ç†
- CreatorId: ãƒãƒƒã‚·ãƒ¥ç”Ÿæˆãƒ»æ¤œè¨¼
- Session: ãƒ‡ãƒã‚¤ã‚¹è­˜åˆ¥æƒ…å ±
- Quiz: ä½œæˆè€…ã¨ã®ç´ä»˜ã‘

**è²¬ä»»**:
```typescript
interface CreatorIdentificationService {
  // ä½œæˆè€…è­˜åˆ¥æƒ…å ±ç”Ÿæˆ
  generateCreatorId(deviceInfo: DeviceInfo): CreatorId;
  
  // ä½œæˆè€…ã®æ¤œè¨¼
  verifyCreator(creatorId: CreatorId): boolean;
  
  // åŒ¿åæ€§ã®ä¿è¨¼
  ensureAnonymity(creator: Creator): void;
  
  // é‡è¤‡æŠ•ç¨¿ã®è¨±å¯åˆ¤å®š
  allowDuplicateSubmission(creator: Creator, quiz: Quiz): boolean;
}
```

#### 4. SessionSyncServiceï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³åŒæœŸã‚µãƒ¼ãƒ“ã‚¹ï¼‰
**å”èª¿ã™ã‚‹æ¦‚å¿µ**:
- Session: åŒæœŸå¯¾è±¡ã‚»ãƒƒã‚·ãƒ§ãƒ³
- AnswerHistory: åŒæœŸå¯¾è±¡å±¥æ­´
- OfflineStorage: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿
- RemoteStorage: ã‚µãƒ¼ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿
- ConflictResolver: ç«¶åˆè§£æ±º

**è²¬ä»»**:
```typescript
interface SessionSyncService {
  // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ¤œå‡º
  detectOfflineMode(): boolean;
  
  // ãƒ‡ãƒ¼ã‚¿åŒæœŸå®Ÿè¡Œ
  syncSession(session: Session): SyncResult;
  
  // ç«¶åˆè§£æ±º
  resolveConflicts(localData: AnswerHistory, remoteData: AnswerHistory): AnswerHistory;
  
  // åŒæœŸçŠ¶æ…‹ç®¡ç†
  getSyncStatus(session: Session): SyncStatus;
}
```

### ã‚µãƒ¼ãƒ“ã‚¹å€™è£œã®è²¬ä»»ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

#### ã‚µãƒ¼ãƒ“ã‚¹é–“ã®å”èª¿é–¢ä¿‚
```mermaid
graph TD
    CreatorIdentificationService -->|provides| Quiz
    Quiz -->|requires| QuizApprovalService
    QuizApprovalService -->|approved quiz| AnswerProcessingService
    AnswerProcessingService -->|updates| SessionSyncService
    
    SessionSyncService -->|syncs| AnswerHistory
    AnswerHistory -->|belongs to| Session
    Session -->|managed by| CreatorIdentificationService
```

#### é›†ç´„å¢ƒç•Œã¸ã®å½±éŸ¿
**ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆã‹ã‚‰è¦‹ãˆã‚‹é›†ç´„å¢ƒç•Œ**:

1. **Quizé›†ç´„**: Quiz + Question + CorrectAnswer + Explanation + Tag
   - ã‚µãƒ¼ãƒ“ã‚¹: QuizApprovalServiceï¼ˆå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
   
2. **LearningSessioné›†ç´„**: Session + AnswerHistory + Answer
   - ã‚µãƒ¼ãƒ“ã‚¹: AnswerProcessingService, SessionSyncServiceï¼ˆé›†ç´„å†…ã‚µãƒ¼ãƒ“ã‚¹ï¼‰
   
3. **Identityé›†ç´„**: Creator + CreatorId
   - ã‚µãƒ¼ãƒ“ã‚¹: CreatorIdentificationServiceï¼ˆé›†ç´„å†…ã‚µãƒ¼ãƒ“ã‚¹ï¼‰

## å®Ÿè£…ã¸ã®ç¤ºå”†

### æ¦‚å¿µãƒãƒƒãƒ—ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹è¨­è¨ˆåŸå‰‡

#### 1. ä¾å­˜é–¢ä¿‚ã®æ–¹å‘æ€§
- é«˜æŠ½è±¡åº¦ â†’ ä½æŠ½è±¡åº¦ã®ä¾å­˜ã®ã¿è¨±å¯
- åŒä¸€æŠ½è±¡åº¦ã§ã®å¾ªç’°ä¾å­˜ã®å›é¿
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚ˆã‚‹æ¦‚å¿µé–“å”èª¿ã®å®Ÿç¾

#### 2. è²¬ä»»åˆ†æ•£ã®åŸå‰‡
- å„æ¦‚å¿µã¯å˜ä¸€è²¬ä»»ã‚’æŒã¤
- å”èª¿ãŒå¿…è¦ãªå‡¦ç†ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã«å§”è­²
- æ¦‚å¿µé–“ã®ç›´æ¥çš„ãªè¤‡é›‘ãªç›¸äº’ä½œç”¨ã‚’é¿ã‘ã‚‹

#### 3. é–¢ä¿‚æ€§ã®æœ€å°åŒ–
- å¿…è¦æœ€å°é™ã®é–¢ä¿‚æ€§ã®ã¿ä¿æŒ
- ä¸€æ™‚çš„ãªé–¢ä¿‚ã¯å‚ç…§æ¸¡ã—ã§å®Ÿç¾
- æ°¸ç¶šçš„ãªé–¢ä¿‚ã®ã¿é›†ç´„å†…ã«åŒ…å«

### TypeScriptå®Ÿè£…æŒ‡é‡

#### æ¦‚å¿µã®å‹è¡¨ç¾
```typescript
// é«˜æŠ½è±¡åº¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
interface Quiz {
  readonly id: QuizId;
  readonly question: Question;
  readonly correctAnswer: CorrectAnswer;
  readonly explanation?: Explanation;
  readonly tags: Tag[];
  readonly creator: CreatorId;
  status: QuizStatus;
}

// ä¸­æŠ½è±¡åº¦å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
interface Question {
  readonly text: string;
  validate(): ValidationResult;
  sanitize(): Question;
}

// ä½æŠ½è±¡åº¦ã‚µãƒ¼ãƒ“ã‚¹
interface SwipeGestureHandler {
  detect(touchEvent: TouchEvent): SwipeGesture;
  interpret(gesture: SwipeGesture): boolean; // true=â—¯, false=Ã—
}
```

#### é–¢ä¿‚æ€§ã®å®Ÿè£…
```typescript
// åŒ…å«é–¢ä¿‚ï¼ˆé›†ç´„å†…ï¼‰
class Quiz {
  private readonly question: Question;
  private readonly correctAnswer: CorrectAnswer;
  
  public judge(userAnswer: boolean): boolean {
    return this.correctAnswer.equals(userAnswer);
  }
}

// å‚ç…§é–¢ä¿‚ï¼ˆé›†ç´„é–“ï¼‰
class Answer {
  constructor(
    private readonly quizId: QuizId,
    private readonly userAnswer: boolean,
    private readonly session: Session
  ) {}
}

// ã‚µãƒ¼ãƒ“ã‚¹é–¢ä¿‚ï¼ˆå”èª¿å‡¦ç†ï¼‰
class AnswerProcessingService {
  process(gesture: SwipeGesture, quiz: Quiz, session: Session): AnswerResult {
    const userAnswer = this.gestureHandler.interpret(gesture);
    const isCorrect = quiz.judge(userAnswer);
    const answer = new Answer(quiz.id, userAnswer, session);
    
    return new AnswerResult(answer, isCorrect);
  }
}
```
```

## åˆ©ç‚¹ãƒ»æ¬ ç‚¹

### åˆ©ç‚¹
- âœ… **é–¢ä¿‚æ€§å¯è¦–åŒ–**: æ¦‚å¿µé–“ã®è¤‡é›‘ãªé–¢ä¿‚ãŒç›´æ„Ÿçš„ã«ç†è§£å¯èƒ½
- âœ… **éšå±¤æ§‹é€ æ˜ç¢º**: æŠ½è±¡åº¦ãƒ¬ãƒ™ãƒ«ã«ã‚ˆã‚‹è¨­è¨ˆæŒ‡é‡ã®æä¾›
- âœ… **ã‚µãƒ¼ãƒ“ã‚¹è‡ªç„¶æŠ½å‡º**: æ¦‚å¿µé–“å”èª¿ã‹ã‚‰è‡ªç„¶ãªã‚µãƒ¼ãƒ“ã‚¹å€™è£œå°å‡º
- âœ… **å®Ÿè£…æŒ‡é‡**: ä¾å­˜é–¢ä¿‚ãƒ»è²¬ä»»åˆ†æ•£ã®å…·ä½“çš„æŒ‡é‡

### æ¬ ç‚¹
- âŒ **å›³è¡¨ä½œæˆè² è·**: Mermaidå›³ç­‰ã®ä½œæˆãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å·¥æ•°
- âŒ **é–¢ä¿‚æ€§éå¤š**: è¤‡é›‘ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã¯é–¢ä¿‚æ€§ãŒè¤‡é›‘åŒ–
- âŒ **æŠ½è±¡åŒ–éåº¦**: æ¦‚å¿µã®éšå±¤åŒ–ã«ã‚ˆã‚‹éåº¦ãªæŠ½è±¡åŒ–ãƒªã‚¹ã‚¯

## é©ç”¨å ´é¢
- ãƒ‰ãƒ¡ã‚¤ãƒ³æ¦‚å¿µé–“ã®é–¢ä¿‚ãŒè¤‡é›‘ãªå ´åˆ
- è¦–è¦šçš„ãªç†è§£ãƒ»ãƒãƒ¼ãƒ å…±æœ‰ã‚’é‡è¦–ã™ã‚‹å ´åˆ
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®è²¬ä»»è¨­è¨ˆã‚’é‡è¦è¦–ã™ã‚‹å ´åˆ
- æ®µéšçš„ãªå®Ÿè£…é †åºã®æ±ºå®šãŒå¿…è¦ãªå ´åˆ